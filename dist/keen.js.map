{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 70b7b1a153e34c503101","webpack:///./src/keen-js-simple.js"],"names":["Keen","setOptions","newOptions","hasOwnProperty","options","projectId","writeKey","post","Error","baseURL","queueTime","mergeData","sendEvent","event","plainData","data","_prepareEventData","queue","_eventQueue","push","_debounceTimer","getQueue","clearQueue","createInstance","_post","baseUrl","$","url","ajax","type","headers","Authorization","contentType","crossDomain","xhrFields","withCredentials","JSON","stringify","dataType","i","timer","_queueTimer","window","clearTimeout","setTimeout","_processQueue","keen","timestamp","Date"],"mappings":"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","file":"keen.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"keen\"] = factory();\n\telse\n\t\troot[\"keen\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 70b7b1a153e34c503101\n **/","/**\n * This library allows sending data to Keen.IO.\n *\n * @class Keen\n * @public\n */\nconst Keen = function() {\n\n  /**\n   * Set global options.\n   * Only set options will be set, so you can safely set only single options like this:\n   *\n   * ´´´js\n   * keen.setOptions({ queueTime: 4000 });\n   * ```\n   *\n   * @method setOptions\n   * @param {Object} newOptions The new options to set\n   * @return {Object} The full options object\n   * @public\n   */\n  let setOptions = function(newOptions) {\n    if (typeof newOptions !== 'object') {\n      return;\n    }\n\n    if (newOptions.hasOwnProperty('projectId')) {\n      options.projectId = newOptions.projectId;\n    }\n\n    if (newOptions.hasOwnProperty('writeKey')) {\n      options.writeKey = newOptions.writeKey;\n    }\n\n    if (newOptions.hasOwnProperty('post')) {\n      if (typeof newOptions.post !== 'function') {\n        throw new Error('post needs to be a function!');\n      }\n      options.post = newOptions.post;\n    }\n\n    if (newOptions.hasOwnProperty('baseURL')) {\n      options.baseURL = newOptions.baseURL;\n    }\n\n    if (newOptions.hasOwnProperty('queueTime')) {\n      if (typeof newOptions.queueTime !== 'number') {\n        throw new Error('queueTime needs to be a number, representing the ms to wait for other events!');\n      }\n      options.queueTime = newOptions.queueTime;\n    }\n\n    if (newOptions.hasOwnProperty('mergeData')) {\n      if (typeof newOptions.mergeData !== 'function') {\n        throw new Error('mergeData needs to be a function!');\n      }\n      options.mergeData = newOptions.mergeData;\n    }\n\n    return options;\n  };\n\n  /**\n   * Send an event to Keen.\n   * This will be debounced for the number of ms defined in queueTime.\n   *\n   * @method sendEvent\n   * @param {String} event The name of the event to send\n   * @param {Object} plainData The data to attach to the event.\n   * @public\n   */\n  let sendEvent = function(event, plainData) {\n    if (!plainData) {\n      plainData = {};\n    }\n    if (typeof plainData !== 'object') {\n      throw new Error('data must be an object');\n    }\n\n    let data = _prepareEventData(plainData);\n\n    let queue = _eventQueue;\n    if (queue.hasOwnProperty(event)) {\n      queue[event].push(data);\n    } else {\n      queue[event] = [data];\n    }\n\n    _debounceTimer();\n  };\n\n  /**\n   * Get the queued events.\n   *\n   * @method getQueue\n   * @return {Object}\n   * @public\n   */\n  let getQueue = function() {\n    return _eventQueue;\n  };\n\n  /**\n   * Clear all queued events.\n   *\n   * @method clearQueu\n   * @public\n   */\n  let clearQueue = function() {\n    _eventQueue = {};\n  };\n\n  /**\n   * Create a new keen instance.\n   *\n   * @method createInstance\n   * @return {Keen}\n   * @public\n   */\n  let createInstance = function() {\n    return new Keen();\n  };\n\n  /**\n   * The default post function uses jQuery's $.post to send data.\n   *\n   * @method _post\n   * @param {Object} data The full data to send\n   * @param {Object} options The options are passed and can be used to build the ajax request\n   * @return {jQuery.post}\n   * @private\n   */\n  let _post = function(data, options) {\n    let baseUrl = options.baseURL;\n    let projectId = options.projectId;\n    let writeKey = options.writeKey;\n\n    // Check if all dependencies are loaded && all properties are set\n    if (typeof $ === 'undefined') {\n      throw new Error('The default post method of keen requires jQuery. You need to either include jQuery, or provide a custom post method.');\n    }\n\n    if (!baseUrl) {\n      throw new Error('The baseURL of keen is not set correctly.');\n    }\n\n    if (!projectId) {\n      throw new Error('The projectId of keen is not set correctly.');\n    }\n\n    if (!writeKey) {\n      throw new Error('The writeKey of keen is not set correctly.');\n    }\n\n    let url = baseUrl + '/' + projectId + '/events?api_key=' + writeKey;\n\n    return $.ajax({\n      type: 'POST',\n      headers: {\n        Authorization: writeKey\n      },\n      url: url,\n      contentType: 'application/json',\n      crossDomain: true,\n      xhrFields: {\n        withCredentials: false\n      },\n      data: JSON.stringify(data),\n      dataType: 'json'\n    });\n  };\n\n  /**\n   * This function merges the data from mergeData() into event data.\n   *\n   * @method _prepareEventData\n   * @param {Object} data The object to merge data into. This will be mutated!\n   * @return {Object} The object with the data merged into it\n   * @private\n   */\n  let _prepareEventData = function(data) {\n    let mergeData = options.mergeData();\n\n    for (let i in mergeData) {\n      if (mergeData.hasOwnProperty(i)) {\n        data[i] = mergeData[i];\n      }\n    }\n\n    return data;\n  };\n\n  /**\n   * Debounce the timer to process the queue.\n   * This will wait for queueTime ms to actually run the queue.\n   * If the function is called again before that time, it will be reset.\n   * This means that the queue runs only if no data has been added for the specified time.\n   *\n   * @method _debounceTimer\n   * @private\n   */\n  let _debounceTimer = function() {\n    let queueTime = options.queueTime;\n    let timer = _queueTimer;\n\n    if (timer) {\n      window.clearTimeout(timer);\n    }\n\n    _queueTimer = window.setTimeout(_processQueue, queueTime);\n  };\n\n  /**\n   * Actually process the queue and send the data.\n   *\n   * @method _processQueu\n   * @private\n   */\n  let _processQueue = function() {\n    let data = _eventQueue;\n    options.post(data, options);\n    _eventQueue = {};\n  };\n\n  /**\n   * The keen options.\n   * These can be set via keen.setOptions().\n   *\n   * @property options\n   * @type {Object}\n   * @protected\n   */\n  let options = {\n    projectId: null,\n    writeKey: null,\n    queueTime: 5000,\n    baseURL: 'https://api.keen.io/3.0/projects',\n    post: _post,\n    mergeData: function() {\n      return {\n        keen: {\n          timestamp: new Date()\n        }\n      };\n    }\n  };\n\n  /**\n   * This hols the queued events, keyed by event name.\n   *\n   * @property _eventQueue\n   * @type {Object}\n   * @private\n   */\n  let _eventQueue = {};\n\n  /**\n   * This is the reference to the queue timer, which is used so it can be canceled.\n   *\n   * @property _queueTimer\n   * @type {null|Timeout}\n   * @private\n   */\n  let _queueTimer = null;\n\n  return {\n    setOptions,\n    options,\n    sendEvent,\n    getQueue,\n    clearQueue,\n    createInstance\n  };\n};\n\nconst keen = new Keen();\n\nexport default keen;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/keen-js-simple.js\n **/"],"sourceRoot":""}