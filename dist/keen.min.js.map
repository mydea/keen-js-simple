{"version":3,"sources":["keen.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","_typeof","Symbol","iterator","obj","constructor","prototype","Keen","setOptions","newOptions","hasOwnProperty","options","projectId","writeKey","post","Error","baseURL","queueTime","mergeData","sendEvent","event","plainData","data","_prepareEventData","queue","_eventQueue","push","_debounceTimer","getQueue","clearQueue","createInstance","_post","baseUrl","$","url","ajax","type","headers","Authorization","contentType","crossDomain","xhrFields","withCredentials","JSON","stringify","dataType","i","timer","_queueTimer","window","clearTimeout","setTimeout","_processQueue","keen","timestamp","Date","default"],"mappings":"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","file":"keen.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"keen\"] = factory();\n\telse\n\t\troot[\"keen\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/**\n\t * This library allows sending data to Keen.IO.\n\t *\n\t * @class Keen\n\t * @public\n\t */\n\tvar Keen = function Keen() {\n\t\n\t  /**\n\t   * Set global options.\n\t   * Only set options will be set, so you can safely set only single options like this:\n\t   *\n\t   * ´´´js\n\t   * keen.setOptions({ queueTime: 4000 });\n\t   * ```\n\t   *\n\t   * @method setOptions\n\t   * @param {Object} newOptions The new options to set\n\t   * @return {Object} The full options object\n\t   * @public\n\t   */\n\t  var setOptions = function setOptions(newOptions) {\n\t    if ((typeof newOptions === 'undefined' ? 'undefined' : _typeof(newOptions)) !== 'object') {\n\t      return;\n\t    }\n\t\n\t    if (newOptions.hasOwnProperty('projectId')) {\n\t      options.projectId = newOptions.projectId;\n\t    }\n\t\n\t    if (newOptions.hasOwnProperty('writeKey')) {\n\t      options.writeKey = newOptions.writeKey;\n\t    }\n\t\n\t    if (newOptions.hasOwnProperty('post')) {\n\t      if (typeof newOptions.post !== 'function') {\n\t        throw new Error('post needs to be a function!');\n\t      }\n\t      options.post = newOptions.post;\n\t    }\n\t\n\t    if (newOptions.hasOwnProperty('baseURL')) {\n\t      options.baseURL = newOptions.baseURL;\n\t    }\n\t\n\t    if (newOptions.hasOwnProperty('queueTime')) {\n\t      if (typeof newOptions.queueTime !== 'number') {\n\t        throw new Error('queueTime needs to be a number, representing the ms to wait for other events!');\n\t      }\n\t      options.queueTime = newOptions.queueTime;\n\t    }\n\t\n\t    if (newOptions.hasOwnProperty('mergeData')) {\n\t      if (typeof newOptions.mergeData !== 'function') {\n\t        throw new Error('mergeData needs to be a function!');\n\t      }\n\t      options.mergeData = newOptions.mergeData;\n\t    }\n\t\n\t    return options;\n\t  };\n\t\n\t  /**\n\t   * Send an event to Keen.\n\t   * This will be debounced for the number of ms defined in queueTime.\n\t   *\n\t   * @method sendEvent\n\t   * @param {String} event The name of the event to send\n\t   * @param {Object} plainData The data to attach to the event.\n\t   * @public\n\t   */\n\t  var sendEvent = function sendEvent(event, plainData) {\n\t    if (!plainData) {\n\t      plainData = {};\n\t    }\n\t    if ((typeof plainData === 'undefined' ? 'undefined' : _typeof(plainData)) !== 'object') {\n\t      throw new Error('data must be an object');\n\t    }\n\t\n\t    var data = _prepareEventData(plainData);\n\t\n\t    var queue = _eventQueue;\n\t    if (queue.hasOwnProperty(event)) {\n\t      queue[event].push(data);\n\t    } else {\n\t      queue[event] = [data];\n\t    }\n\t\n\t    _debounceTimer();\n\t  };\n\t\n\t  /**\n\t   * Get the queued events.\n\t   *\n\t   * @method getQueue\n\t   * @return {Object}\n\t   * @public\n\t   */\n\t  var getQueue = function getQueue() {\n\t    return _eventQueue;\n\t  };\n\t\n\t  /**\n\t   * Clear all queued events.\n\t   *\n\t   * @method clearQueu\n\t   * @public\n\t   */\n\t  var clearQueue = function clearQueue() {\n\t    _eventQueue = {};\n\t  };\n\t\n\t  /**\n\t   * Create a new keen instance.\n\t   *\n\t   * @method createInstance\n\t   * @return {Keen}\n\t   * @public\n\t   */\n\t  var createInstance = function createInstance() {\n\t    return new Keen();\n\t  };\n\t\n\t  /**\n\t   * The default post function uses jQuery's $.post to send data.\n\t   *\n\t   * @method _post\n\t   * @param {Object} data The full data to send\n\t   * @param {Object} options The options are passed and can be used to build the ajax request\n\t   * @return {jQuery.post}\n\t   * @private\n\t   */\n\t  var _post = function _post(data, options) {\n\t    var baseUrl = options.baseURL;\n\t    var projectId = options.projectId;\n\t    var writeKey = options.writeKey;\n\t\n\t    // Check if all dependencies are loaded && all properties are set\n\t    if (typeof $ === 'undefined') {\n\t      throw new Error('The default post method of keen requires jQuery. You need to either include jQuery, or provide a custom post method.');\n\t    }\n\t\n\t    if (!baseUrl) {\n\t      throw new Error('The baseURL of keen is not set correctly.');\n\t    }\n\t\n\t    if (!projectId) {\n\t      throw new Error('The projectId of keen is not set correctly.');\n\t    }\n\t\n\t    if (!writeKey) {\n\t      throw new Error('The writeKey of keen is not set correctly.');\n\t    }\n\t\n\t    var url = baseUrl + '/' + projectId + '/events?api_key=' + writeKey;\n\t\n\t    return $.ajax({\n\t      type: 'POST',\n\t      headers: {\n\t        Authorization: writeKey\n\t      },\n\t      url: url,\n\t      contentType: 'application/json',\n\t      crossDomain: true,\n\t      xhrFields: {\n\t        withCredentials: false\n\t      },\n\t      data: JSON.stringify(data),\n\t      dataType: 'json'\n\t    });\n\t  };\n\t\n\t  /**\n\t   * This function merges the data from mergeData() into event data.\n\t   *\n\t   * @method _prepareEventData\n\t   * @param {Object} data The object to merge data into. This will be mutated!\n\t   * @return {Object} The object with the data merged into it\n\t   * @private\n\t   */\n\t  var _prepareEventData = function _prepareEventData(data) {\n\t    var mergeData = options.mergeData();\n\t\n\t    for (var i in mergeData) {\n\t      if (mergeData.hasOwnProperty(i)) {\n\t        data[i] = mergeData[i];\n\t      }\n\t    }\n\t\n\t    return data;\n\t  };\n\t\n\t  /**\n\t   * Debounce the timer to process the queue.\n\t   * This will wait for queueTime ms to actually run the queue.\n\t   * If the function is called again before that time, it will be reset.\n\t   * This means that the queue runs only if no data has been added for the specified time.\n\t   *\n\t   * @method _debounceTimer\n\t   * @private\n\t   */\n\t  var _debounceTimer = function _debounceTimer() {\n\t    var queueTime = options.queueTime;\n\t    var timer = _queueTimer;\n\t\n\t    if (timer) {\n\t      window.clearTimeout(timer);\n\t    }\n\t\n\t    _queueTimer = window.setTimeout(_processQueue, queueTime);\n\t  };\n\t\n\t  /**\n\t   * Actually process the queue and send the data.\n\t   *\n\t   * @method _processQueu\n\t   * @private\n\t   */\n\t  var _processQueue = function _processQueue() {\n\t    var data = _eventQueue;\n\t    options.post(data, options);\n\t    _eventQueue = {};\n\t  };\n\t\n\t  /**\n\t   * The keen options.\n\t   * These can be set via keen.setOptions().\n\t   *\n\t   * @property options\n\t   * @type {Object}\n\t   * @protected\n\t   */\n\t  var options = {\n\t    projectId: null,\n\t    writeKey: null,\n\t    queueTime: 5000,\n\t    baseURL: 'https://api.keen.io/3.0/projects',\n\t    post: _post,\n\t    mergeData: function mergeData() {\n\t      return {\n\t        keen: {\n\t          timestamp: new Date()\n\t        }\n\t      };\n\t    }\n\t  };\n\t\n\t  /**\n\t   * This hols the queued events, keyed by event name.\n\t   *\n\t   * @property _eventQueue\n\t   * @type {Object}\n\t   * @private\n\t   */\n\t  var _eventQueue = {};\n\t\n\t  /**\n\t   * This is the reference to the queue timer, which is used so it can be canceled.\n\t   *\n\t   * @property _queueTimer\n\t   * @type {null|Timeout}\n\t   * @private\n\t   */\n\t  var _queueTimer = null;\n\t\n\t  return {\n\t    setOptions: setOptions,\n\t    options: options,\n\t    sendEvent: sendEvent,\n\t    getQueue: getQueue,\n\t    clearQueue: clearQueue,\n\t    createInstance: createInstance\n\t  };\n\t};\n\t\n\tvar keen = new Keen();\n\t\n\texports.default = keen;\n\tmodule.exports = exports['default'];\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}